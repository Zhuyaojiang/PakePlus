import{_ as ie}from"./fhsy-a15dcc4e.js";import{i as de}from"./index-e179da42.js";import{d as re,B as ce,r as c,j as ue,a as g,o as p,c as w,b as a,u as q,e as E,g as r,t as u,f as o,w as d,n as P,F as S,l as _e,h as j,y as b,E as G,i as D,p as pe,m as ve}from"./index-5b619166.js";import{s as H,p as Y,h as Z,i as ge,j as ye,k as J}from"./fhjc-f327482c.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";const x=I=>(pe("data-v-e7561d66"),I=I(),ve(),I),he={class:"bj"},fe={class:"title_box"},be=x(()=>a("div",{class:"title"},"企业负荷监测展示大屏",-1)),xe={class:"title_left"},ke={class:"title_right"},we={class:"affairList"},Ce={class:"time"},Ie={class:"table_box"},Ve={class:"top_box"},Ee=x(()=>a("div",{class:"title"},[a("div",{class:"title_name"},"需求响应用户互动服务")],-1)),Se={class:"content"},Le={class:"content_top"},Te=x(()=>a("div",{style:{display:"flex","justify-content":"center"}},[a("div",{class:"content_top_title"},"需求响应任务")],-1)),$e={class:"interList"},Fe={class:"jtkt_box"},Be=x(()=>a("div",{class:"jtkt_box_content"},"调控开始时间",-1)),Ue={class:"jtkt_box_lef"},je={class:"ktj_box"},De=x(()=>a("div",{class:"jtkt_box_content"},"调控结束时间",-1)),ze={class:"jtkt_box_lef"},Me={class:"xydl_box"},Ae=x(()=>a("div",{class:"jtkt_box_content"},"调控量",-1)),Ne={class:"jtkt_box_lef"},Oe={class:"content_butt"},Re=x(()=>a("div",{class:"curve_box"},[a("div",{id:"centre_top_curve"})],-1)),We={key:1},qe=re({__name:"interact",setup(I){const K=ce(),n=c({});n.value=K.query;const y=c({}),L=c({}),z=c(""),T=c(!1),M=c([]),V=c(),C=c(""),$=c(),F=c("");function Q(t){T.value=!0,F.value=t.strategyId,H({strategyId:t.strategyId}).then(e=>{V.value=e.data}),Y({strategyId:t.strategyId}).then(e=>{$.value=e.data}),Z({strategyId:t.strategyId}).then(e=>{O(e.data)})}function X(t){H({strategyId:t}).then(e=>{V.value=e.data}),Y({strategyId:t}).then(e=>{$.value=e.data}),Z({strategyId:t}).then(e=>{O(e.data)})}const ee=t=>{V.value.forEach(e=>{e.isEditing=e.collects_name===t.collects_name})},te=t=>{let e={strategyId:F.value,...t};ge(e).then(l=>{l.code==200&&(X(F.value),b({message:"保存成功",type:"success"}))}),t.isEditing=!1},ae=t=>{b({message:"已取消！",type:"info"}),t.isEditing=!1};function A(t){return t.split(" ")[0]}function N(){return"headerBg"}function le(t){C.value=t}function se(){ye({}).then(t=>{M.value=t.data})}function oe(t){let e={state:t,id:n.value.id,strategyId:C.value.strategyId};G.confirm(`确认不参与需求响应任务(任务ID: ${n.value.id})吗？`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{J(e).then(l=>{l.code==200&&(b({message:"不参与成功！",type:"success"}),E.push("/loadMonitoring/taskList"),setTimeout(()=>{window.location.reload()},400))})}).catch(()=>{b({type:"info",message:"已取消！"})})}function ne(t){let e={state:t,id:n.value.id,strategyId:C.value.strategyId};C.value==""?b({message:"请选择需要下发的数据",type:"warning"}):G.confirm(`确认参与需求响应任务(任务ID: ${n.value.id})吗？`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{J(e).then(l=>{l.code==200&&(b({message:"参与成功！",type:"success"}),E.push("/loadMonitoring/taskList"),setTimeout(()=>{window.location.reload()},400))}),C.value="",L.value=""}).catch(()=>{b({type:"info",message:"已取消！"})})}const O=async t=>{let e=document.getElementById("centre_top_curve");e.removeAttribute("_echarts_instance_");let l=de(e),i={backgroundColor:"rgba(255,255,255,0)",title:{text:"单位：(kW)",textStyle:{color:"#FFF",fontSize:12},top:"5%",left:"2%"},tooltip:{trigger:"axis"},dataZoom:[{type:"inside",xAxisIndex:0,orient:"vertical"},{type:"slider",show:!1,xAxisIndex:0}],legend:{data:t.nameList,icon:"rich",show:!0,itemWidth:20,itemHeight:8,textStyle:{color:"#FFF",fontSize:"12px"},top:8,right:"3%",itemGap:34},grid:{left:"4%",right:"4%",bottom:"7%",top:"18%",containLabel:!0},xAxis:{data:t.xData,type:"category",boundaryGap:!1,axisLine:{symbol:"none",lineStyle:{color:"#50637A"}},axisTick:{show:!1},axisLabel:{color:"#FFF",fontSize:12,padding:[10,0,0,0]}},yAxis:{type:"value",axisLabel:{color:"#FFF",fontSize:12,padding:[0,10,0,0]},splitLine:{lineStyle:{color:"#50637A",type:"dashed"}}},series:t.data.map(m=>({name:m.name,type:"line",step:m.step,data:m.data}))};i.series,l.setOption(i),window.addEventListener("resize",()=>{l.resize()})};ue(()=>{y.value=R(),se(),z.value=localStorage.getItem("xqxyList")});function R(){let t=new Date,e=t.getFullYear(),l=t.getMonth()+1,i=t.getDate(),m=t.getDay(),h=t.getHours(),k=t.getMinutes(),f=t.getSeconds(),B=["日","一","二","三","四","五","六"];return l<10&&(l="0"+l),i<10&&(i="0"+i),h<10&&(h="0"+h),k<10&&(k="0"+k),f<10&&(f="0"+f),{n:`${e}`,y:l,r:i,x:`${B[m]}`,s:`${h}:${k}:${f}`}}return setInterval(()=>{y.value=R()},1e3),(t,e)=>{const l=g("el-table-column"),i=g("el-button"),m=g("el-radio"),h=g("el-table"),k=g("el-input"),f=g("el-option"),B=g("el-select"),W=g("el-dialog");return p(),w("div",he,[a("div",fe,[be,a("div",xe,[a("img",{src:ie,alt:"",onClick:e[0]||(e[0]=s=>q(E).push("/home/index"))})]),a("div",ke,[a("div",we,[a("div",null,[r(" 需求响应任务数: "),a("span",null,u(z.value),1)])]),a("div",Ce,[a("div",null,[a("span",null,u(y.value.n),1),r(" 年 "),a("span",null,u(y.value.y),1),r(" 月 "),a("span",null,u(y.value.r),1),r(" 日 ")]),a("div",null,[r(" 星期"),a("span",null,u(y.value.x+" "+y.value.s),1)])])])]),a("div",Ie,[a("div",Ve,[Ee,a("div",Se,[a("div",Le,[Te,a("div",$e,[a("div",Fe,[Be,a("div",Ue,u(A(n.value.taskStartTime)),1)]),a("div",je,[De,a("div",ze,u(A(n.value.taskEndTime)),1)]),a("div",Me,[Ae,a("div",Ne,u(n.value.resourceRegulate)+"kWh",1)])])]),o(h,{data:M.value,stripe:"",style:{width:"100%",height:"calc((100vh - 500px))"},"header-cell-class-name":N},{default:d(()=>[o(l,{type:"index",label:"序号",width:"60",align:"center"}),o(l,{prop:"strategyId",label:"策略id",align:"center"}),o(l,{prop:"strategyColonyId",label:"参与负荷集群",align:"center"}),o(l,{prop:"regulatingGas",label:"调控目标差距(kWh)",align:"center"}),o(l,{prop:"economicalOptimization",label:"预期收益(元)",align:"center"}),o(l,{prop:"strategyColonyId",label:"调控计划",align:"center"},{default:d(s=>[o(i,{type:"text",onClick:v=>Q(s.row)},{default:d(()=>[r("查看")]),_:2},1032,["onClick"])]),_:1}),o(l,{label:"选择",align:"center"},{default:d(s=>[o(m,{modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=v=>L.value=v),label:s.$index,onChange:v=>le(s.row)},{default:d(()=>[r(u(""))]),_:2},1032,["modelValue","label","onChange"])]),_:1})]),_:1},8,["data"]),a("div",Oe,[o(i,{class:"btn",onClick:e[2]||(e[2]=s=>q(E).push("/loadMonitoring/taskList"))},{default:d(()=>[r("返 回")]),_:1}),o(i,{style:{"margin-left":"4%"},onClick:e[3]||(e[3]=s=>ne(2)),disabled:n.value.stateCode==="2"||n.value.stateCode==="3",class:P(n.value.stateCode=="2"||n.value.stateCode=="3"?"btn_bcy":"btn")},{default:d(()=>[r("参 与 ")]),_:1},8,["disabled","class"]),o(i,{class:P(n.value.stateCode=="2"||n.value.stateCode=="3"?"btn_bcy":"btn"),style:{"margin-left":"4%"},onClick:e[4]||(e[4]=s=>oe(3)),disabled:n.value.stateCode==="2"||n.value.stateCode==="3"},{default:d(()=>[r(" 不参与 ")]),_:1},8,["class","disabled"])])])])]),o(W,{modelValue:T.value,"onUpdate:modelValue":e[5]||(e[5]=s=>T.value=s),title:"调控计划",width:"65%"},{default:d(()=>[Re,a("div",null,[o(h,{data:V.value,stripe:"",style:{width:"100%",height:"calc((100vh - 660px))"},"header-cell-class-name":N},{default:d(()=>[o(l,{type:"index",label:"序号",width:"60",align:"center"}),o(l,{prop:"collectsName",label:"集群名称",align:"center"}),(p(!0),w(S,null,_e($.value,(s,v)=>(p(),j(l,{key:v,prop:s,label:s,align:"center"},{default:d(_=>[_.row.isEditing?_.row.isEditing?(p(),w(S,{key:1},[_.row.type!=1?(p(),j(k,{key:0,modelValue:_.row[s],"onUpdate:modelValue":U=>_.row[s]=U,size:"small",style:{width:"80%"}},null,8,["modelValue","onUpdate:modelValue"])):D("",!0),_.row.type==1?(p(),w("div",We,[o(B,{modelValue:_.row[s],"onUpdate:modelValue":U=>_.row[s]=U,placeholder:"请选择",style:{width:"80%"}},{default:d(()=>[o(f,{label:"合闸",value:"合闸"}),o(f,{label:"分闸",value:"分闸"})]),_:2},1032,["modelValue","onUpdate:modelValue"])])):D("",!0)],64)):D("",!0):(p(),w(S,{key:0},[r(u(_.row[s]),1)],64))]),_:2},1032,["prop","label"]))),128)),o(l,{prop:"strategyColonyId",label:"操作",width:"200",align:"center"},{default:d(s=>[s.row.isEditing?(p(),w(S,{key:1},[o(i,{type:"success",onClick:v=>te(s.row)},{default:d(()=>[r("保存")]),_:2},1032,["onClick"]),o(i,{type:"info",onClick:v=>ae(s.row)},{default:d(()=>[r("取消")]),_:2},1032,["onClick"])],64)):(p(),j(i,{key:0,type:"success",onClick:v=>ee(s.row)},{default:d(()=>[r(" 修改 ")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"])])}}});const Je=me(qe,[["__scopeId","data-v-e7561d66"]]);export{Je as default};
