import{h as f,r as i,o as j,a as c,b as D,c as R,d as s,e,w as n,f as x,p as B,g as L}from"./index-fa0873e6.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";const M=p=>f.post("/excel/import/material",p),N=p=>f.post("/excel/import/part",p,{responseType:"blob","Content-Type":"multipart/form-data"}),O=p=>f.post("/excel/data/material",p);const S=p=>(B("data-v-6a19fc1c"),p=p(),L(),p),T={class:"file-conversion-container"},E=S(()=>s("h1",{class:"page-title"},"文件转换",-1)),z={class:"content-wrapper"},A={class:"form-section"},J={class:"button-group"},G={class:"table-section"},H={style:{display:"flex","justify-content":"flex-end","margin-bottom":"10px"}},K={__name:"index",setup(p){const b=i(null),t=i({khmc:"",cpmc:"",cpbh:"",cplx:"",cpfl:"",cpdw:"",qdbh:"",ljbh:""}),y={khmc:[{required:!0,message:"请输入客户名称",trigger:"blur"}],cpmc:[{required:!0,message:"请输入产品名称",trigger:"blur"}],cpbh:[{required:!0,message:"请输入产品编号",trigger:"blur"}],cplx:[{required:!0,message:"请输入产品型号",trigger:"blur"}],cpfl:[{required:!0,message:"请输入产品分类",trigger:"blur"}],cpdw:[{required:!0,message:"请输入产品单位",trigger:"blur"}],qdbh:[{required:!0,message:"请输入清单编号",trigger:"blur"}],ljbh:[{required:!0,message:"请输入零件编号",trigger:"blur"}]},_=i([]),h=i(null),g=i(null);function m(){O({}).then(d=>{_.value=d})}async function V(){h.value.click()}function w(){const d=event.target.files[0],l=new FormData;l.append("file",d),M(l).then(o=>{m(),event.target.value=""})}const k=async()=>{g.value.click()},U=async d=>{const l=d.target.files[0],o=new FormData;if(o.append("file",l),o.append("param",JSON.stringify(t.value)),!!l)try{await b.value.validate(),await N(o).then(a=>{q(a),m(),d.target.value=""})}catch(a){d.target.value=""}},q=d=>{let l="BOM清单.xlsx";const o=window.URL.createObjectURL(new Blob([d])),a=document.createElement("a");a.href=o,a.setAttribute("download",l),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(o)};return j(()=>{m()}),(d,l)=>{const o=c("el-input"),a=c("el-form-item"),I=c("el-form"),v=c("el-button"),u=c("el-table-column"),C=c("el-table");return D(),R("div",T,[E,s("div",z,[s("div",A,[e(I,{model:t.value,rules:y,ref_key:"formRef",ref:b,"label-width":"120px"},{default:n(()=>[e(a,{label:"客户名称",prop:"khmc"},{default:n(()=>[e(o,{modelValue:t.value.khmc,"onUpdate:modelValue":l[0]||(l[0]=r=>t.value.khmc=r),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),e(a,{label:"产品名称",prop:"cpmc"},{default:n(()=>[e(o,{modelValue:t.value.cpmc,"onUpdate:modelValue":l[1]||(l[1]=r=>t.value.cpmc=r),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),e(a,{label:"产品编号",prop:"cpbh"},{default:n(()=>[e(o,{modelValue:t.value.cpbh,"onUpdate:modelValue":l[2]||(l[2]=r=>t.value.cpbh=r),placeholder:"请输入产品编号"},null,8,["modelValue"])]),_:1}),e(a,{label:"产品型号",prop:"cplx"},{default:n(()=>[e(o,{modelValue:t.value.cplx,"onUpdate:modelValue":l[3]||(l[3]=r=>t.value.cplx=r),placeholder:"请输入产品型号"},null,8,["modelValue"])]),_:1}),e(a,{label:"产品分类",prop:"cpfl"},{default:n(()=>[e(o,{modelValue:t.value.cpfl,"onUpdate:modelValue":l[4]||(l[4]=r=>t.value.cpfl=r),placeholder:"请输入产品分类"},null,8,["modelValue"])]),_:1}),e(a,{label:"产品单位",prop:"cpdw"},{default:n(()=>[e(o,{modelValue:t.value.cpdw,"onUpdate:modelValue":l[5]||(l[5]=r=>t.value.cpdw=r),placeholder:"请输入产品单位"},null,8,["modelValue"])]),_:1}),e(a,{label:"清单编号",prop:"qdbh"},{default:n(()=>[e(o,{modelValue:t.value.qdbh,"onUpdate:modelValue":l[6]||(l[6]=r=>t.value.qdbh=r),placeholder:"请输入清单编号"},null,8,["modelValue"])]),_:1}),e(a,{label:"零件编号",prop:"ljbh"},{default:n(()=>[e(o,{modelValue:t.value.ljbh,"onUpdate:modelValue":l[7]||(l[7]=r=>t.value.ljbh=r),placeholder:"请输入零件编号"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",J,[e(v,{type:"success",onClick:k},{default:n(()=>[x(" 点击上传导入清单 "),s("input",{type:"file",ref_key:"importInput",ref:g,onChange:U,style:{display:"none"},accept:".xlsx,.xls,.csv"},null,544)]),_:1})])]),s("div",G,[s("div",H,[e(v,{type:"primary",onClick:V},{default:n(()=>[x(" 点击上传材质清单 "),s("input",{type:"file",ref_key:"materialInput",ref:h,onInput:w,style:{display:"none"},accept:".xlsx,.xls,.csv"},null,544)]),_:1})]),e(C,{data:_.value,border:"",style:{width:"100%"}},{default:n(()=>[e(u,{type:"index",label:"序号",width:"60",align:"center"}),e(u,{prop:"cz",label:"材质"}),e(u,{prop:"bom",label:"对应BOM中材质"}),e(u,{prop:"cpmc",label:"产品名称"}),e(u,{prop:"cpbh",label:"产品编号"}),e(u,{prop:"cpxh",label:"产品型号"}),e(u,{prop:"cpfl",label:"产品分类"}),e(u,{prop:"cpjs",label:"产品角色"}),e(u,{prop:"dw",label:"单位"})]),_:1},8,["data"])])])])}}},W=F(K,[["__scopeId","data-v-6a19fc1c"]]);export{W as default};
